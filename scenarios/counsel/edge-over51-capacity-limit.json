{
  "id": "counsel-edge-over51-capacity-limit",
  "name": "51세 이상 대면 capacity 부족 시 제한 모달",
  "type": "test",
  "requiresAuth": true,
  "variables": [
    "baseUrl",
    "entryType",
    "userId",
    "userName",
    "userPhone",
    "userGender"
  ],
  "defaults": {
    "entryType": "OTHER"
  },
  "precondition": "InPerson 대면 상담 capacity가 부족한 상태 (환경/시점에 따라 다름)",
  "description": "51세 이상 유저 → 주제 선택 → 다음 → capacity 부족 → Over51 제한 모달 표시",
  "steps": [
    {
      "action": "loadState",
      "description": "저장된 인증 상태 로드"
    },
    {
      "action": "setSessionStorage",
      "key": "__instech_counsel_entry__",
      "value": "{{entryType}}",
      "description": "EntryType 설정"
    },
    {
      "action": "navigate",
      "url": "{{baseUrl}}/counsel/topics",
      "description": "상담 주제 선택 페이지로 이동"
    },
    {
      "action": "waitForNavigation",
      "description": "페이지 로딩 대기"
    },
    {
      "action": "fetchAndInjectUserInfo",
      "store": "COUNSEL",
      "userData": {
        "userId": "{{userId}}",
        "name": "{{userName}}",
        "phoneNumber": "{{userPhone}}",
        "birthDate": "19740101",
        "gender": "{{userGender}}"
      },
      "description": "유저 정보를 store에 주입 (51세 이상)"
    },
    {
      "action": "click",
      "selector": "input[type='checkbox']",
      "description": "첫 번째 주제 선택"
    },
    {
      "action": "waitForTimeout",
      "timeout": 500
    },
    {
      "action": "click",
      "selector": "button:has-text('다음')",
      "description": "'다음' 버튼 클릭 (주제) → capacity API 호출"
    },
    {
      "action": "waitForTimeout",
      "timeout": 2000,
      "description": "capacity API 응답 대기"
    },
    {
      "action": "expect",
      "type": "visible",
      "selector": ":text('상담이 어려워요')",
      "description": "Over51 제한 모달 타이틀 확인"
    },
    {
      "action": "expect",
      "type": "visible",
      "selector": ":text('다음 달에 신청해 주세요')",
      "description": "Over51 제한 모달 서브타이틀 확인"
    },
    {
      "action": "expect",
      "type": "visible",
      "selector": "button:has-text('신청 가능할 때 알림 받기')",
      "description": "'신청 가능할 때 알림 받기' 버튼 확인"
    },
    {
      "action": "expect",
      "type": "visible",
      "selector": "button:has-text('닫기')",
      "description": "'닫기' 버튼 확인"
    },
    {
      "action": "screenshot",
      "description": "Over51 제한 모달 스크린샷"
    },
    {
      "action": "click",
      "selector": "button:has-text('닫기')",
      "description": "'닫기' 버튼 클릭"
    },
    {
      "action": "waitForTimeout",
      "timeout": 500
    },
    {
      "action": "expect",
      "type": "hidden",
      "selector": ":text('상담이 어려워요')",
      "description": "모달 닫힘 확인"
    },
    {
      "action": "screenshot",
      "description": "모달 닫힌 후 topics 페이지 스크린샷"
    }
  ],
  "category": "edge"
}
