{
  "id": "counsel-inperson-gender-x-terms-agreed",
  "name": "상담 신청 - 대면 (성별 미입력, 약관 동의됨)",
  "type": "test",
  "requiresAuth": true,
  "variables": [
    "baseUrl",
    "entryType",
    "userId",
    "userName",
    "userPhone",
    "userBirthDate"
  ],
  "defaults": {
    "entryType": "OTHER"
  },
  "precondition": "상담 약관에 이미 동의한 상태",
  "description": "주제 선택 → 대면 상담 선택 → 지역/일정 선택 → 정보 수정 → 상담 신청 완료",
  "steps": [
    {
      "action": "loadState",
      "description": "저장된 인증 상태 로드"
    },
    {
      "action": "cancelExistingCounsel",
      "baseUrl": "{{baseUrl}}",
      "description": "기존 상담 신청이 있으면 취소"
    },
    {
      "action": "setSessionStorage",
      "key": "__instech_counsel_entry__",
      "value": "{{entryType}}",
      "description": "EntryType 설정"
    },
    {
      "action": "navigate",
      "url": "{{baseUrl}}/counsel/topics",
      "description": "상담 주제 선택 페이지로 이동"
    },
    {
      "action": "waitForNavigation",
      "description": "페이지 로딩 대기"
    },
    {
      "action": "fetchAndInjectUserInfo",
      "store": "COUNSEL",
      "userData": {
        "userId": "{{userId}}",
        "name": "{{userName}}",
        "phoneNumber": "{{userPhone}}",
        "birthDate": "{{userBirthDate}}",
        "gender": ""
      },
      "description": "유저 정보를 store에 주입 (gender X — 성별 미입력)"
    },
    {
      "action": "screenshot",
      "description": "주제 선택 페이지 스크린샷"
    },
    {
      "action": "click",
      "selector": "input[type='checkbox']",
      "description": "첫 번째 주제 선택"
    },
    {
      "action": "waitForTimeout",
      "timeout": 500
    },
    {
      "action": "click",
      "selector": "button:has-text('다음')",
      "description": "'다음' 버튼 클릭 (주제)"
    },
    {
      "action": "waitForNavigation",
      "description": "상담 방식 선택 페이지 로딩 대기"
    },
    {
      "action": "screenshot",
      "description": "상담 방식 선택 페이지 스크린샷"
    },
    {
      "action": "click",
      "selector": ":text('만나서 상담')",
      "description": "'만나서 상담' 상담 방식 선택"
    },
    {
      "action": "expect",
      "type": "visible",
      "selector": ":text('보험 점검에 추천드려요')",
      "description": "'만나서 상담' 선택 상태 확인"
    },
    {
      "action": "waitForTimeout",
      "timeout": 500
    },
    {
      "action": "click",
      "selector": "button:has-text('다음')",
      "description": "'다음' 버튼 클릭 (방식)"
    },
    {
      "action": "waitForTimeout",
      "timeout": 1000
    },
    {
      "action": "waitForNavigation",
      "description": "일정/지역 선택 페이지 로딩 대기"
    },
    {
      "action": "screenshot",
      "description": "일정/지역 선택 페이지 스크린샷"
    },
    {
      "action": "click",
      "selector": ":text('편한 지역을 선택해주세요')",
      "description": "지역 선택 셀렉터 클릭"
    },
    {
      "action": "waitForTimeout",
      "timeout": 1000
    },
    {
      "action": "click",
      "selector": ":text('서울')",
      "description": "'서울' 선택"
    },
    {
      "action": "waitForTimeout",
      "timeout": 500
    },
    {
      "action": "click",
      "selector": ":text('강남구')",
      "description": "'강남구' 선택"
    },
    {
      "action": "waitForTimeout",
      "timeout": 1000
    },
    {
      "action": "click",
      "selector": "button:has-text('시간 상관없음')",
      "description": "'시간 상관없음' 시간대 선택"
    },
    {
      "action": "waitForTimeout",
      "timeout": 500
    },
    {
      "action": "screenshot",
      "description": "지역/시간대 선택 완료 스크린샷"
    },
    {
      "action": "click",
      "selector": "button:has-text('다음')",
      "description": "'다음' 버튼 클릭 (일정)"
    },
    {
      "action": "waitForTimeout",
      "timeout": 1000
    },
    {
      "action": "waitForNavigation",
      "description": "정보 수정 페이지 로딩 대기"
    },
    {
      "action": "screenshot",
      "description": "정보 수정 페이지 스크린샷"
    },
    {
      "action": "fill",
      "selector": "input[placeholder='이름']",
      "value": "테스트",
      "description": "이름 입력"
    },
    {
      "action": "blur",
      "selector": "input[placeholder='이름']",
      "description": "이름 필드 blur"
    },
    {
      "action": "fill",
      "selector": "input[placeholder='휴대폰 번호']",
      "value": "01012345678",
      "description": "전화번호 입력"
    },
    {
      "action": "blur",
      "selector": "input[placeholder='휴대폰 번호']",
      "description": "전화번호 필드 blur"
    },
    {
      "action": "fill",
      "selector": "input[placeholder='생년월일']",
      "value": "900101",
      "description": "생년월일 입력 (YYMMDD)"
    },
    {
      "action": "fill",
      "selector": "input[aria-label='주민등록번호 뒷자리 첫 번째 숫자']",
      "value": "1",
      "description": "성별 코드 입력"
    },
    {
      "action": "blur",
      "selector": "input[aria-label='주민등록번호 뒷자리 첫 번째 숫자']",
      "description": "성별 필드 blur"
    },
    {
      "action": "waitForTimeout",
      "timeout": 500
    },
    {
      "action": "screenshot",
      "description": "정보 입력 완료 스크린샷"
    },
    {
      "action": "click",
      "selector": "button:has-text('다음')",
      "description": "'다음' 버튼 클릭 (정보 수정)"
    },
    {
      "action": "waitForTimeout",
      "timeout": 1000
    },
    {
      "action": "waitForNavigation",
      "description": "완료 페이지 로딩 대기"
    },
    {
      "action": "waitForTimeout",
      "timeout": 3000,
      "description": "자동 신청 처리 대기"
    },
    {
      "action": "expect",
      "type": "visible",
      "selector": ":text('상담 신청 완료')",
      "description": "'상담 신청 완료' 텍스트 확인"
    },
    {
      "action": "screenshot",
      "description": "완료 페이지 스크린샷"
    }
  ]
}
